<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alumed Pro | Microsc√≥pio AI Inteligente</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.0/openseadragon.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        * { font-family: 'Inter', sans-serif; }
        body { overflow: hidden; margin: 0; padding: 0; }
        .openseadragon-canvas:focus { outline: none; }
        
        /* ========== NEON BACKGROUND ========== */
        body {
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #16213e 100%);
            background-attachment: fixed;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at 50% 0%, rgba(0, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }
        
        /* Canvas de desenho */
        #drawing-canvas {
            position: absolute;
            top: 0;
            left: 0;
            cursor: crosshair;
            z-index: 5;
        }
        
        /* ========== NEON GLOW EFFECTS ========== */
        .tool-btn {
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            border: 2px solid transparent;
            background: linear-gradient(135deg, #0f172a 0%, #1a0a2e 100%);
        }
        
        .tool-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 8px;
            padding: 2px;
            background: linear-gradient(135deg, #00ff88 0%, #00ffff 50%, #ff006e 100%);
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .tool-btn.active {
            background: linear-gradient(135deg, #00ff88 0%, #00ffff 100%);
            box-shadow: 
                0 0 10px #00ff88,
                0 0 20px #00ffff,
                0 0 40px #00ffff,
                inset 0 0 10px rgba(0, 255, 136, 0.5);
            transform: scale(1.08);
            color: #000;
            font-weight: 600;
        }
        
        .tool-btn:hover:not(.active) {
            box-shadow: 
                0 0 15px #ff006e,
                0 0 30px #ff006e,
                inset 0 0 5px rgba(255, 0, 110, 0.3);
            transform: translateY(-3px);
        }
        
        /* ========== COLOR PICKER NEON ========== */
        .color-swatch {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
            box-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
        }
        
        .color-swatch:hover {
            border-color: currentColor;
            box-shadow: 0 0 12px currentColor, 0 0 24px currentColor;
            transform: scale(1.1);
        }
        
        .color-swatch.active {
            border-color: currentColor;
            box-shadow: 
                0 0 10px currentColor, 
                0 0 20px currentColor,
                0 0 40px currentColor,
                inset 0 0 10px rgba(255, 255, 255, 0.3);
            transform: scale(1.15);
        }
        
        /* ========== SIDEBAR NEON ========== */
        .sidebar {
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.95) 0%, rgba(26, 10, 46, 0.95) 100%);
            backdrop-filter: blur(10px);
            border-right: 2px solid;
            border-image: linear-gradient(135deg, #00ff88, #00ffff, #ff006e) 1;
            box-shadow: 
                -10px 0 40px rgba(0, 255, 255, 0.2),
                inset 0 0 20px rgba(0, 255, 136, 0.05);
        }
        
        /* ========== HEADER NEON ========== */
        .sidebar > div:first-child {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 255, 0.1) 100%);
            border-bottom: 2px solid;
            border-image: linear-gradient(90deg, #00ff88, #00ffff) 1;
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }
        
        .sidebar h1 {
            text-shadow: 
                0 0 10px #00ff88,
                0 0 20px #00ffff,
                0 0 30px #00ffff;
            animation: neonFlicker 3s ease-in-out infinite;
        }
        
        @keyframes neonFlicker {
            0%, 100% { 
                text-shadow: 
                    0 0 10px #00ff88,
                    0 0 20px #00ffff,
                    0 0 30px #00ffff;
                opacity: 1;
            }
            50% { 
                text-shadow: 
                    0 0 5px #00ff88,
                    0 0 10px #00ffff;
                opacity: 0.9;
            }
        }
        
        /* ========== SECTIONS ========== */
        .sidebar > div:nth-child(2) > div {
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.6) 0%, rgba(26, 10, 46, 0.6) 100%) !important;
            border: 1px solid rgba(0, 255, 255, 0.2) !important;
            box-shadow: 
                0 0 10px rgba(0, 255, 255, 0.1),
                inset 0 0 10px rgba(0, 255, 136, 0.02) !important;
            transition: all 0.3s;
        }
        
        .sidebar > div:nth-child(2) > div:hover {
            border-color: rgba(0, 255, 136, 0.5) !important;
            box-shadow: 
                0 0 20px rgba(0, 255, 136, 0.3),
                inset 0 0 10px rgba(0, 255, 136, 0.05) !important;
        }
        
        .sidebar h2 {
            color: #00ff88;
            text-shadow: 0 0 10px #00ff88;
        }
        
        /* ========== BUTTONS IN SIDEBAR ========== */
        .sidebar button {
            border: 1px solid rgba(0, 255, 136, 0.3);
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.05) 0%, rgba(0, 255, 255, 0.05) 100%);
            transition: all 0.3s;
        }
        
        .sidebar button:hover {
            border-color: #00ffff;
            box-shadow: 
                0 0 10px #00ffff,
                inset 0 0 10px rgba(0, 255, 255, 0.1);
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.15) 0%, rgba(0, 255, 255, 0.15) 100%);
        }
        
        /* ========== MAIN VIEWER NEON ========== */
        main {
            background: linear-gradient(135deg, #000000 0%, #0a0a1a 100%);
            box-shadow: inset 0 0 50px rgba(0, 255, 255, 0.05);
        }
        
        /* ========== CONTROLS NEON ========== */
        .absolute.top-6 {
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.9) 0%, rgba(26, 10, 46, 0.9) 100%) !important;
            backdrop-filter: blur(10px);
            border: 2px solid;
            border-image: linear-gradient(135deg, #00ff88, #00ffff, #ff006e) 1 !important;
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.3),
                inset 0 0 20px rgba(0, 255, 136, 0.05) !important;
        }
        
        .absolute.top-6 button {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 255, 255, 0.1) 100%);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: #00ffff;
            transition: all 0.3s;
        }
        
        .absolute.top-6 button:hover {
            background: linear-gradient(135deg, #00ff88 0%, #00ffff 100%);
            box-shadow: 
                0 0 15px #00ffff,
                0 0 30px #00ffff,
                inset 0 0 10px rgba(255, 255, 255, 0.2);
            color: #000;
            font-weight: 600;
            transform: scale(1.1);
        }
        
        /* ========== BOTTOM INFO ========== */
        .absolute.bottom-6.left-6 {
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.9) 0%, rgba(26, 10, 46, 0.9) 100%) !important;
            border: 1px solid rgba(0, 255, 136, 0.4) !important;
            box-shadow: 
                0 0 20px rgba(0, 255, 136, 0.2),
                inset 0 0 10px rgba(0, 255, 136, 0.05) !important;
            color: #00ffff;
            text-shadow: 0 0 5px #00ffff;
        }
        
        .absolute.bottom-6.right-6 {
            background: linear-gradient(135deg, rgba(10, 10, 26, 0.9) 0%, rgba(26, 10, 46, 0.9) 100%) !important;
            border: 1px solid rgba(0, 255, 255, 0.4) !important;
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.2),
                inset 0 0 10px rgba(0, 255, 255, 0.05) !important;
        }
        
        /* ========== ANIMATIONS ========== */
        @keyframes neonPulse {
            0%, 100% { 
                box-shadow: 0 0 10px currentColor, 0 0 20px currentColor;
            }
            50% { 
                box-shadow: 0 0 20px currentColor, 0 0 40px currentColor;
            }
        }
        
        @keyframes glitch {
            0%, 100% { clip-path: inset(0 0 0 0); }
            20% { clip-path: inset(10% 0 20% 0); }
            40% { clip-path: inset(5% 0 10% 0); }
            60% { clip-path: inset(8% 0 15% 0); }
            80% { clip-path: inset(3% 0 5% 0); }
        }
        
        /* Tooltip neon */
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2) 0%, rgba(0, 255, 255, 0.2) 100%);
            color: #00ffff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 11px;
            white-space: nowrap;
            border: 1px solid #00ffff;
            box-shadow: 0 0 10px #00ffff;
            z-index: 20;
            text-shadow: 0 0 5px #00ffff;
        }
    </style>
</head>
<body class="h-screen w-screen overflow-hidden bg-black text-white flex">

    <!-- SIDEBAR ESQUERDA -->
    <aside class="sidebar w-96 border-r border-slate-700 flex flex-col z-10 shadow-2xl">
        
        <!-- Header -->
        <div class="p-6 border-b border-slate-700 bg-gradient-to-r from-slate-900 to-slate-800">
            <div class="flex items-center gap-3 mb-2">
                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-cyan-400 to-lime-400 flex items-center justify-center shadow-lg" style="box-shadow: 0 0 20px rgba(34, 197, 94, 0.5);">
                    <i class="fas fa-microscope text-black font-bold"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-lime-400">
                        Alumed NEO
                    </h1>
                    <p class="text-xs text-cyan-400" style="text-shadow: 0 0 5px #00ffff;">v3.0 ‚Ä¢ CYBER</p>
                </div>
            </div>
        </div>

        <!-- Conte√∫do da Sidebar -->
        <div class="flex-1 overflow-y-auto p-5 space-y-6">
            
            <!-- L√¢mina Atual -->
            <div class="bg-slate-800/50 backdrop-blur rounded-xl p-4 border border-slate-700 hover:border-teal-500/50 transition">
                <h2 class="text-xs uppercase tracking-widest font-bold mb-3">üìÑ L√¢mina Carregada</h2>
                <h3 class="font-semibold text-lime-300 text-sm">Cardioesophageal Junction</h3>
                <p class="text-xs text-cyan-300 mt-2" style="text-shadow: 0 0 3px #00ffff;">Colora√ß√£o: HE ‚Ä¢ Magnifica√ß√£o: 10x</p>
                <div class="mt-3 h-1 bg-gradient-to-r from-lime-400 via-cyan-400 to-pink-500 rounded-full" style="box-shadow: 0 0 10px rgba(34, 197, 94, 0.6);"></div>
            </div>

            <!-- Ferramentas de Desenho -->
            <div>
                <h2 class="text-xs uppercase tracking-widest font-bold mb-3">üé® Ferramentas</h2>
                <div class="grid grid-cols-3 gap-2 mb-3">
                    <button onclick="setTool('pen')" class="tool-btn active p-3 rounded-lg bg-teal-600/30 border border-teal-500/50 hover:bg-teal-600/50 tooltip" data-tooltip="Caneta (P)">
                        <i class="fas fa-pen text-lime-400"></i>
                    </button>
                    <button onclick="setTool('eraser')" class="tool-btn p-3 rounded-lg bg-slate-700 border border-slate-600 hover:border-teal-500/30 tooltip" data-tooltip="Borracha (E)">
                        <i class="fas fa-eraser text-cyan-300"></i>
                    </button>
                    <button onclick="setTool('circle')" class="tool-btn p-3 rounded-lg bg-slate-700 border border-slate-600 hover:border-teal-500/30 tooltip" data-tooltip="C√≠rculo (C)">
                        <i class="fas fa-circle text-cyan-300"></i>
                    </button>
                    <button onclick="setTool('rectangle')" class="tool-btn p-3 rounded-lg bg-slate-700 border border-slate-600 hover:border-teal-500/30 tooltip" data-tooltip="Ret√¢ngulo (R)">
                        <i class="fas fa-square text-cyan-300"></i>
                    </button>
                    <button onclick="setTool('arrow')" class="tool-btn p-3 rounded-lg bg-slate-700 border border-slate-600 hover:border-teal-500/30 tooltip" data-tooltip="Seta (A)">
                        <i class="fas fa-arrow-right text-cyan-300"></i>
                    </button>
                    <button onclick="clearDrawing()" class="tool-btn p-3 rounded-lg bg-red-500/20 border border-red-500/30 hover:bg-red-500/30 tooltip" data-tooltip="Limpar (C+L)">
                        <i class="fas fa-trash text-red-400"></i>
                    </button>
                </div>
            </div>

            <!-- Cores -->
            <div>
                <h2 class="text-xs uppercase tracking-widest font-bold mb-3">üåà Cores Neon</h2>
                <div class="grid grid-cols-6 gap-2">
                    <div class="color-swatch active" style="background: #00ff88; box-shadow: 0 0 10px #00ff88;" onclick="setColor('#00ff88')" title="Lime Green"></div>
                    <div class="color-swatch" style="background: #00ffff; box-shadow: 0 0 10px #00ffff;" onclick="setColor('#00ffff')" title="Cyan"></div>
                    <div class="color-swatch" style="background: #ff006e; box-shadow: 0 0 10px #ff006e;" onclick="setColor('#ff006e')" title="Hot Pink"></div>
                    <div class="color-swatch" style="background: #ffbe0b; box-shadow: 0 0 10px #ffbe0b;" onclick="setColor('#ffbe0b')" title="Electric Yellow"></div>
                    <div class="color-swatch" style="background: #8338ec; box-shadow: 0 0 10px #8338ec;" onclick="setColor('#8338ec')" title="Purple"></div>
                    <div class="color-swatch" style="background: #ffffff; box-shadow: 0 0 10px #ffffff;" onclick="setColor('#ffffff')" title="White"></div>
                </div>
            </div>

            <!-- Espessura -->
            <div>
                <h2 class="text-xs uppercase tracking-widest font-bold mb-3">‚úèÔ∏è Espessura</h2>
                <input type="range" id="brush-size" min="1" max="20" value="3" 
                    class="w-full cursor-pointer accent-lime-400">
                <div class="flex justify-between mt-2">
                    <span class="text-xs text-cyan-400">Fina</span>
                    <span class="text-sm font-semibold text-lime-400" id="size-display">3px</span>
                    <span class="text-xs text-cyan-400">Grossa</span>
                </div>
            </div>

            <!-- Estruturas Identificadas -->
            <div>
                <h2 class="text-xs uppercase tracking-widest font-bold mb-3">üî¨ Estruturas Mapeadas</h2>
                <div class="space-y-2">
                    <button onclick="focusStructure(0.5, 0.5, 5)" 
                        class="w-full text-left p-3 rounded-lg bg-slate-700/50 hover:bg-teal-600/30 transition-all border border-slate-600 group">
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-sm text-lime-300">Vilosidades Intestinais</span>
                            <span class="text-xs bg-slate-900 px-2 py-1 rounded text-cyan-400 group-hover:text-lime-300">4x</span>
                        </div>
                    </button>
                    <button onclick="focusStructure(0.2, 0.4, 20)" 
                        class="w-full text-left p-3 rounded-lg bg-slate-700/50 hover:bg-teal-600/30 transition-all border border-slate-600 group">
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-sm text-lime-300">Criptas de Lieberk√ºhn</span>
                            <span class="text-xs bg-slate-900 px-2 py-1 rounded text-cyan-400 group-hover:text-lime-300">20x</span>
                        </div>
                    </button>
                    <button class="w-full mt-3 p-3 rounded-lg border border-lime-400 text-lime-400 flex items-center justify-center gap-2 hover:bg-lime-500/20 transition font-semibold text-sm" style="text-shadow: 0 0 5px #00ff88;">
                        <i class="fas fa-bolt"></i>
                        Analisar com IA (Profe Joy)
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="p-4 border-t border-slate-700 bg-gradient-to-r from-slate-900/50 to-slate-800/50 text-xs text-center text-cyan-400">
            ‚ö° <span class="text-lime-400 font-semibold">ALUMED</span> v3.0 NEO
        </div>
    </aside>

    <!-- MAIN VIEWER -->
    <main class="flex-1 relative bg-black">
        
        <!-- OpenSeadragon Viewer -->
        <div id="openseadragon-viewer" class="w-full h-full"></div>
        
        <!-- Canvas de Desenho (overlay) -->
        <canvas id="drawing-canvas"></canvas>

        <!-- Controles Principais (estilo Neon) -->
        <div class="absolute top-6 right-6 flex flex-col gap-3 bg-slate-900/90 backdrop-blur p-3 rounded-xl border border-slate-700 shadow-2xl">
            <!-- Zoom In -->
            <button id="zoom-in" class="p-3 hover:bg-lime-600 rounded-lg text-white transition-all tooltip" data-tooltip="Zoom In (+)">
                <i class="fas fa-plus text-lg"></i>
            </button>
            
            <!-- Zoom Display -->
            <div class="px-3 py-2 text-center text-xs font-bold text-lime-400 bg-slate-800/50 rounded border border-lime-500/30" style="text-shadow: 0 0 5px #00ff88;">
                <span id="zoom-level">100%</span>
            </div>
            
            <!-- Zoom Out -->
            <button id="zoom-out" class="p-3 hover:bg-cyan-600 rounded-lg text-white transition-all tooltip" data-tooltip="Zoom Out (-)">
                <i class="fas fa-minus text-lg"></i>
            </button>
            
            <!-- Separador -->
            <div class="h-px bg-gradient-to-r from-lime-500 to-cyan-500"></div>
            
            <!-- Home/Reset -->
            <button id="home" class="p-3 hover:bg-pink-600 rounded-lg text-white transition-all tooltip" data-tooltip="Resetar (H)">
                <i class="fas fa-home text-lg"></i>
            </button>
            
            <!-- Fullscreen -->
            <button onclick="toggleFullscreen()" class="p-3 hover:bg-purple-600 rounded-lg text-white transition-all tooltip" data-tooltip="Fullscreen (F)">
                <i class="fas fa-expand text-lg"></i>
            </button>
        </div>

        <!-- Coordenadas e Info -->
        <div class="absolute bottom-6 left-6 bg-slate-900/90 backdrop-blur px-4 py-3 rounded-xl border border-slate-700 text-xs font-mono text-cyan-300 shadow-2xl" style="text-shadow: 0 0 5px #00ffff;">
            <div>X: <span id="coord-x" class="text-lime-400">0</span> | Y: <span id="coord-y" class="text-lime-400">0</span></div>
            <div class="mt-1 text-cyan-400">Zoom: <span id="zoom-display" class="text-lime-400">1.0x</span></div>
        </div>

        <!-- Mini Mapa -->
        <div class="absolute bottom-6 right-6 bg-slate-900/95 backdrop-blur rounded-xl border border-cyan-500/30 overflow-hidden shadow-2xl" style="width: 180px; height: 180px; box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);">
            <div id="minimap-canvas" style="width: 100%; height: 100%; background: linear-gradient(135deg, #000000 0%, #0a0a1a 100%);" class="relative">
                <div class="absolute inset-0 flex items-center justify-center text-cyan-500 text-xs" style="text-shadow: 0 0 5px #00ffff;">
                    <i class="fas fa-map"></i>&nbsp;Mini Map
                </div>
            </div>
        </div>
    </main>

    <script type="text/javascript">
        // ============= VARI√ÅVEIS GLOBAIS =============
        let currentTool = 'pen';
        let currentColor = '#14b8a6';
        let brushSize = 3;
        let isDrawing = false;
        let startX, startY;

        // ============= INICIALIZA√á√ÉO DO OPENSEADRAGON =============
        const viewer = OpenSeadragon({
            id: "openseadragon-viewer",
            prefixUrl: "https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.0/images/",
            tileSources: {
                type: 'image',
                url: 'imagens_laminas/lamina_0.jpg',
                buildPyramid: false
            },
            animationTime: 0.5,
            blendTime: 0.1,
            constrainDuringPan: true,
            visibilityRatio: 1.0,
            minZoomLevel: 0.5,
            maxZoomLevel: 20,
            defaultZoomLevel: 1,
            zoomInButton: "zoom-in",
            zoomOutButton: "zoom-out",
            homeButton: "home",
        });

        // ============= SETUP DO CANVAS DE DESENHO =============
        const canvas = document.getElementById('drawing-canvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // ============= FUN√á√ïES DE DESENHO =============
        canvas.addEventListener('mousedown', (e) => {
            isDrawing = true;
            startX = e.clientX;
            startY = e.clientY;
        });

        canvas.addEventListener('mousemove', (e) => {
            if (!isDrawing) return;
            
            const x = e.clientX;
            const y = e.clientY;
            
            ctx.strokeStyle = currentColor;
            ctx.lineWidth = brushSize;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';

            if (currentTool === 'pen') {
                ctx.globalCompositeOperation = 'source-over';
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(x, y);
                ctx.stroke();
            } else if (currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.clearRect(x - brushSize, y - brushSize, brushSize * 2, brushSize * 2);
            }

            startX = x;
            startY = y;

            // Atualizar coordenadas
            document.getElementById('coord-x').textContent = Math.round(x);
            document.getElementById('coord-y').textContent = Math.round(y);
        });

        canvas.addEventListener('mouseup', () => {
            isDrawing = false;
        });

        // ============= FERRAMENTAS =============
        function setTool(tool) {
            currentTool = tool;
            document.querySelectorAll('.tool-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.tool-btn').classList.add('active');
            canvas.style.cursor = tool === 'eraser' ? 'grab' : 'crosshair';
        }

        function setColor(color) {
            currentColor = color;
            document.querySelectorAll('.color-swatch').forEach(swatch => swatch.classList.remove('active'));
            event.target.classList.add('active');
        }

        function clearDrawing() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // ============= SLIDER DE ESPESSURA =============
        document.getElementById('brush-size').addEventListener('input', (e) => {
            brushSize = e.target.value;
            document.getElementById('size-display').textContent = brushSize + 'px';
        });

        // ============= NAVEGA√á√ÉO =============
        function focusStructure(x, y, zoom) {
            const point = new OpenSeadragon.Point(x, y);
            viewer.viewport.panTo(point);
            viewer.viewport.zoomTo(zoom);
        }

        // ============= ATUALIZAR ZOOM DISPLAY =============
        viewer.addHandler('zoom', () => {
            const zoom = viewer.viewport.getZoom();
            document.getElementById('zoom-level').textContent = Math.round(zoom * 100) + '%';
            document.getElementById('zoom-display').textContent = zoom.toFixed(1) + 'x';
        });

        // ============= FULLSCREEN =============
        function toggleFullscreen() {
            const elem = document.querySelector('main');
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) {
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullscreen) {
                elem.webkitRequestFullscreen();
            }
        }

        // ============= ATALHOS DE TECLADO =============
        document.addEventListener('keydown', (e) => {
            if (e.key === 'p' || e.key === 'P') setTool('pen');
            if (e.key === 'e' || e.key === 'E') setTool('eraser');
            if (e.key === 'c' || e.key === 'C') setTool('circle');
            if (e.key === 'r' || e.key === 'R') setTool('rectangle');
            if (e.key === 'a' || e.key === 'A') setTool('arrow');
            if (e.key === 'h' || e.key === 'H') viewer.viewport.goHome();
            if (e.key === 'f' || e.key === 'F') toggleFullscreen();
            if (e.key === '+' || e.key === '=') viewer.viewport.zoomBy(1.2);
            if (e.key === '-') viewer.viewport.zoomBy(0.8);
        });

        // ============= INICIALIZA√á√ÉO =============
        console.log('üöÄ Alumed Pro v2.0 iniciado!');
        console.log('üìù Atalhos: P=Caneta, E=Borracha, C=C√≠rculo, R=Ret√¢ngulo, A=Seta, H=Home, F=Fullscreen');

    </script>
</body>
</html>